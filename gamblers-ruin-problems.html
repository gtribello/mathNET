<!-- === BEGIN HEADER === -->
<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
	<!-- Title -->
	<title>Gamblers Ruin Problems : Exercise</title>
	<!-- Meta -->
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="description" content="">
	<meta name="author" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
	<!-- Favicon -->
	<link href="favicon.html" rel="shortcut icon">
	<!-- Bootstrap Core CSS -->
	<link rel="stylesheet" href="assets/css/bootstrap.css" rel="stylesheet">
	<!-- Template CSS -->
	<link rel="stylesheet" href="assets/css/animate.css" rel="stylesheet">
	<link rel="stylesheet" href="assets/css/font-awesome.css" rel="stylesheet">
	<link rel="stylesheet" href="assets/css/nexus.css" rel="stylesheet">
	<link rel="stylesheet" href="assets/css/responsive.css" rel="stylesheet">
	<link rel="stylesheet" href="assets/css/custom.css" rel="stylesheet">
	<!-- Google Fonts-->
	<link href="http://fonts.googleapis.com/css?family=Lato:400,300" rel="stylesheet" type="text/css">
	<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" rel="stylesheet" type="text/css">
        <!-- MathJax -->
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
        </script>
        <script type="text/javascript" async
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
        </script> 
</head>
<body>
	<div id="pre_header" class="visible-lg"></div>
	<div id="header" class="container">
		<div class="row">
			<!-- Logo -->
			<div class="logo">
				<a href="index.html" title="">
					<img src="assets/img/logo.png" alt="Logo" />
				</a>
			</div>
			<!-- End Logo -->
			<!-- Top Menu -->
			<div class="col-md-12 margin-top-30">
				<div id="hornav" class="pull-right visible-lg">
					<ul class="nav navbar-nav">
						<li><a href="index.html">Home</a></li>
                                                <li><span>Modules</span>
                                                <ul>
                                                  <li><span><a href="PHY9038.html">PHY9038</a></span></li>
<li><span><a href="AMA4004.html">AMA4004</a></span></li>
<li><span><a href="SOR3012.html">SOR3012</a></span></li>

					        </ul>				</div>
				</div>
				<div class="clear"></div>
				<!-- End Top Menu -->
			</div>
		</div>
		<!-- === END HEADER === -->
		<!-- === BEGIN CONTENT === -->
		<div id="content" class="container">
                    <div class="panel panel-blue">
                      <div class="panel-heading">
                          <h1 class="panel-title"> Gamblers Ruin Problems : Exercises</h1>
                      </div>
                      <H1> Introduction </H1>
<DESCRIPTION>
   Gamblers ruin is a problem involving a particular discrete time Markov chain.  The transition matrix for
   this Markov chain has a special symmetry, which ensures that it is possible to find the hitting probabilities
   by solving a homogeneous difference equation.  Elsewhere on this site there are exercises that will take you 
   through the process of solving this particular problem.  On this page we focus on problems that one can solve 
   by using the solutions that you find when you solve these difference equations with some clever mathematical tricks.
  </DESCRIPTION>
  <H1> Example problems </H1>
<p> Click on the problems to reveal the solution </p> 
<h4> Problem 1</h4><div id="accordion" class="panel-group"> 
<div class="panel panel-default">
    <div class="panel-heading">
        <h4 class="panel-title">
        <a class="accordion-toggle" href="#collapse-0" data-parent="#accordion" data-toggle="collapse">
<QUESTION>
         Consider the symmetric (random) walk of an ant along a line. The ant takes a step  either left or right each second, with equal probability,
         and the size of the step is always one unit.  Suppose that there is an  absorbing barrier at $x=N$: if the ant reaches this
         point it stays there forever. There is also a reflecting barrier at $x=0$: if the ant reaches $x=0$ it moves back to $x=1$ at the next step. 
         Let $s_{kj}$ be the probability that the ant, having started from the point $x=k$, visits $x=0$, $j$ times before it stops permanently at 
         $x=N$. We make the convention that if $k=0$ then the starting point counts as one visit. Show  that:
         $$
         s_{kj} = { N-k \over N^2 } \left( 1 - {1 \over N} \right)^{j-1}
         \qquad \qquad j \geq 1, \qquad 0 \leq k \leq N  \qquad .
         $$
         Hint: Recall that for the symmetric random walk, $p = q$, with absorbing barriers at $x=0$ and $x=N$, starting at x = k, the probability 
         of finishing at $x = 0$ is 
         $$
         p_k = 1  -{k \over N}  \quad .
         $$
      </QUESTION>
              </a>
        </h4>
    </div>
    <div id="collapse-0" class="accordion-body collapse">
        <div class="panel-body">
           <div class="row">
<SOLUTION>
         Let's think about the first wall that the ant encounters.  We know (from the hint) that the probability it encounters the reflecting wall at
         $x=0$ first is:
         $$
          p_k = 1  -{k \over N}
         $$
         We also know that if it encounters the reflecting wall at $x=0$ it will, on the next step, be deposited at $x=1$.  The probability, from $x=1$,
         that it will then go on and encounter the reflecting wall at $x=0$ again before it encounters the absorbing wall at $x=N$ is:
         $$
          p_1 = 1  -{1 \over N}
         $$
         which is the equation from the hint with $k=1$
         <br/><br/>
         Events during the later parts of the ants walk are independent of those that occured during the earlier parts of the walk.  We can thus 
         calculate the probability of multiple visits to the reflecting wall by multiplying probabilities of individual events.  In other words:
         $$ 
          P(j\textrm{ visits to reflecting wall} ) = \left(  1  -{k \over N} \right)\left( 1  -{1 \over N} \right)^{j-1}
         $$
         This is the probability of $j$ or more visits to the walk.  We want the probability of exactly $j$ visits.  The probability of moving to the
         absorbing wall at $x=N$ after having been reflected by the wall at $x=0$ is given by:
         $$
          (1 -p_1 ) = 1 - \left( 1 - \frac{1}{N} \right) = \frac{1}{N}
         $$
         Hence the probability of {\bf exactly} $j$ vists to the reflecting wall is:
         $$
          s_{kj} = \left(  1  -{k \over N} \right)\left( 1  -{1 \over N} \right)^{j-1} \frac{1}{N} = \left(\frac{N-k}{N^2}\right)\left( 1  -{1 \over N} \right)^{j-1}
         $$
      </SOLUTION>
             </div>
      </div>
   </div>
</div>
</br>
<h4> Problem 2</h4><div id="accordion" class="panel-group"> 
<div class="panel panel-default">
    <div class="panel-heading">
        <h4 class="panel-title">
        <a class="accordion-toggle" href="#collapse-1" data-parent="#accordion" data-toggle="collapse">
<QUESTION>
        Consider the simple random walk, with absorbing boundaries at $x=0$ and $x=N$, starting at $x=k$. The probability of a step 
        to the right is $p$, and to the left is $q$.  Let $p_k$ be the probability of loss (absorption at $x=0$) and let $d_k$ be the 
        expected value of the duration of the walk.   That is $d_{k}$ is the expected number of steps taken before the walk terminates.
        Let  $X$ be the number of steps to the {\em right} before absorption occurs (at either end), and $Y$ be the corresponding number 
        of steps to the {\em left}, during the walk.  Then clearly: $d_k = \mathbb{E}(X+Y)$.  Hence show that:
        $$
         \mathbb{E}[X] = {1 \over 2}\left\{  d_k -k +N(1-p_k) \right\}  \quad .
        $$
      </QUESTION>
              </a>
        </h4>
    </div>
    <div id="collapse-1" class="accordion-body collapse">
        <div class="panel-body">
           <div class="row">
<SOLUTION> 
       We begin by noting that $d_k = \mathbb{E}(X+Y) = \mathbb{E}(X) + \mathbb{E}(Y)$ by the linearity of expectation function 
       <br/><br/>
       Now consider $X - Y$:
       <ul>
         <li> For walk starting at $k$ and ending at $N$ (win) : $X-Y=N-k$ </li> 
         <li> For walk starting at $k$ and ending at $0$ (loss) : $X-Y=-k$ </li> 
       </ul>
       Lets now consider $\mathbb{E}(X-Y)=\mathbb{E}(X) - \mathbb{E}(Y)$, which is simply:
       $$
       \begin{aligned}
       \mathbb{E}(X-Y) &amp; = (N-k)p(\textrm{win}) - kp(\textrm{loss}) \\
        &amp; = (N-k)(1-p_k) - kp_k \\
        &amp; = N(1-p_k) - k + kp_k - kp_k = N(1-p_k) - k
       \end{aligned}
       $$
       We now have two simultaneous equations:
       $$
       \begin{aligned}
        \mathbb{E}(X) + \mathbb{E}(Y) &amp; = d_k \\
        \mathbb{E}(X) - \mathbb{E}(Y) &amp; = N(1-p_k) - k
       \end{aligned}
       $$
       Adding these together gives:
       $$
       2 \mathbb{E}(X) = d_k - k + N(1 - p_k)
       $$
      </SOLUTION>
             </div>
      </div>
   </div>
</div>
</br>
 
                    </div> 
		</div>
	</div>
	<!-- === END CONTENT === -->
	<!-- === BEGIN FOOTER === -->
	<div id="base">
		<div class="container padding-vert-30">
			<div class="row">
					<!-- Contact Details -->
					<div class="col-md-3 margin-bottom-20">
						<h3 class="margin-bottom-10">Contact Details</h3>
						<p>School of Mathematics and Physics,<br />
						Queen's University Belfast,<br />
						Belfast,<br />
						BT7 1NN</p>
						<p>Email: <a href="mailto:g.tribello@qub.ac.uk">g.tribello@qub.ac.uk</a><br />
						Website: <a href="http://titus.phy.qub.ac.uk/members/gareth/">mywebsite</a></p>
					</div>
					<!-- End Contact Details -->
					<div class="clearfix"></div>
				</div>
			</div>
		</div>
		<!-- Footer Menu -->
		<div id="footer">
			<div class="container">
				<div class="row">
					<div id="copyright" class="col-md-4">
						<p>(c) 2016 Gareth Tribello</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- End Footer Menu -->
</div>
</div>
<!-- JS -->
<script type="text/javascript" src="assets/js/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript" src="assets/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript" src="assets/js/scripts.js"></script>
<!-- Isotope - Portfolio Sorting -->
<script type="text/javascript" src="assets/js/jquery.isotope.js" type="text/javascript"></script>
<!-- Mobile Menu - Slicknav -->
<script type="text/javascript" src="assets/js/jquery.slicknav.js" type="text/javascript"></script>
<!-- Animate on Scroll-->
<script type="text/javascript" src="assets/js/jquery.visible.js" charset="utf-8"></script>
<!-- Slimbox2-->
<script type="text/javascript" src="assets/js/slimbox2.js" charset="utf-8"></script>
<!-- Modernizr -->
<script src="assets/js/modernizr.custom.js" type="text/javascript"></script>
<!-- End JS -->
</body>
</html>
<!-- === END FOOTER === -->
