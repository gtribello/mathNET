<!-- === BEGIN HEADER === -->
<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
        <!-- Title -->
        <title>hitting-time-problems</title>
        <!-- Meta -->
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta name="description" content="">
        <meta name="author" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <!-- Favicon -->
        <link href="favicon.html" rel="shortcut icon">
        <!-- Bootstrap Core CSS -->
        <link rel="stylesheet" href="assets/css/bootstrap.css" rel="stylesheet">
        <!-- W3 stylesheet for badges in level indicator -->
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <!-- Template CSS -->
        <link rel="stylesheet" href="assets/css/animate.css" rel="stylesheet">
        <link rel="stylesheet" href="assets/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" href="assets/css/nexus.css" rel="stylesheet">
        <link rel="stylesheet" href="assets/css/responsive.css" rel="stylesheet">
        <link rel="stylesheet" href="assets/css/custom.css" rel="stylesheet">
        <!-- Google Fonts-->
        <link href="http://fonts.googleapis.com/css?family=Lato:400,300" rel="stylesheet" type="text/css">
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" rel="stylesheet" type="text/css">
        <!-- MathJax -->
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
        </script>
        <script type="text/javascript" async
          src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
        </script> 
        <!-- Blockly -->
        <script src="https://www.google.com/jsapi"></script>
        <script src="blockly/demos/interpreter/acorn_interpreter.js"></script>
        <script src="blockly/blockly_compressed.js"></script>
        <script src="blockly/blocks_compressed.js"></script>
        <script src="blockly/javascript_compressed.js"></script>
        <script src="blockly/python_compressed.js"></script>
        <script src="blockly/msg/js/en.js"></script>
        <!-- My tools -->
        <script src="assets/scripts/isingSpinControls.js" type="text/javascript"> </script>
        <script src="assets/scripts/plottingTools.js" type="text/javascript"> </script>
        <script src="assets/scripts/randomVariables.js" type="text/javascript"> </script>
        <style>
           .w3-badge {cursor:pointer}
           .w3-badge {height:13px;width:13px;padding:0}
        </style>
<style type="text/css">
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

</head>
<div id="pre_header" class="visible-lg"></div>
<div id="header" class="container">
        <div class="row">
                <!-- Logo -->
                <div class="logo">
                        <a href="index.html" title="">
                                <img src="assets/img/logo.png" alt="Logo" />
                        </a>
                </div>
                <!-- End Logo -->                <!-- Top Menu -->                <div class="col-md-12 margin-top-30">
                        <div id="hornav" class="pull-right visible-lg">
                                <ul class="nav navbar-nav">
                                          <li><span>Modules</span>
                                          <ul>
<li class="parent"><span>SOR3012</span><ul><li><a href="SOR3012.html"> SOR3012</a></li><li><a href="SOR30121-overview.html">  Random variables </a></li><li><a href="SOR30122-overview.html">  The central limit theorem </a></li><li><a href="SOR30123-overview.html">  Markov chains in discrete time </a></li><li><a href="SOR30124-overview.html">  Markov chains in continuous time </a></li></ul></li><li class="parent"><span>PHY9038</span><ul><li><a href="PHY9038.html"> PHY9038</a></li><li><a href="PHY90381-overview.html">  Newtons laws </a></li><li><a href="PHY90382-overview.html">  Mathematical prerequisits for statistical mechanics </a></li><li><a href="PHY90383-overview.html">  Statistical mechanics </a></li><li><a href="PHY90384-overview.html">  Computer simulations </a></li></ul></li>                                          </ul>
                                        <li><a href="index.html">Home</a></li>
                        </div>
                </div>
                <div class="clear"></div>
                <!-- End Top Menu -->
        </div>
</div>
<!-- === END HEADER === -->
<div id="content" class="container">   <div class="panel panel-blue">      <div class="panel-heading">         <div class="row">            <div class="col-md-8">                <h1 class="panel-title">Discrete markov chains with absorbing states
: Exercises</h1>            </div>            <div class="col-md-4" align="right">                  <!-- Web2PDF Converter Button BEGIN -->                   <script type="text/javascript">                   var                   pdfbuttonlabel="Save page as PDF"                   </script>                   <script src="http://www.web2pdfconvert.com/pdfbutton2.js" id="Web2PDF" type="text/javascript"></script>                   <!-- Web2PDF Converter Button END -->            </div>         </div>      </div>      <H1> Introduction </H1>
<DESCRIPTION>
In these exercises we consider Markov chains that have a mixture of transient and 
absorbing states.  In problems of this type the aim is almost always to calculate the
probability of finishing in each of the absorbing states and to calculate the expected
number of steps till absorbtion.
</DESCRIPTION>
  <H1> Example problems </H1>
<p> Click on the problems to reveal the solution </p> 
<h4> Problem 1</h4><div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title">        <a class="accordion-toggle" href="#collapse-0" data-parent="#accordion" data-toggle="collapse"><QUESTION>
A discrete random variable, $X$, can take the values $X \in \{0,1,2\}$
according to a discrete Markov Process described by the transition matrix:
$$
\mathbf{P} = \left(
\begin{matrix}
 0.6 &amp; 0.1 &amp; 0.3 \\
 0.2 &amp; 0.2 &amp; 0.6 \\
 0 &amp; 0 &amp; 1 
\end{matrix}
\right)
\nonumber
$$
Find the hitting times for each of the transient states in this
chain. That is find the expected number of steps required until absorption
occurs. 
</QUESTION>
              </a>        </h4>    </div>    <div id="collapse-0" class="accordion-body collapse">        <div class="panel-body">            <div class="row"><SOLUTION>
The Markov chain given in the question has two transient states and one recurrent state.
The recurrent state is state 2 and as such the matrix has already been arranged in the 
required form for this type of problem; namely:
\begin{equation}
 P = \left(
 \begin{matrix}
  Q &amp; R \\
  0 &amp; I 
 \end{matrix}
 \right)
 \nonumber
\end{equation}
with $Q$ connecting the transient states to the transient states and $R$ connecting the transient
states to the recurrent states.  In this question we thus have:
$$
\mathbf{Q} = \left( 
 \begin{matrix}
  0.6 &amp; 0.1 \\
  0.2 &amp; 0.2 
 \end{matrix}
\right)
\qquad \textrm{and} \qquad 
\mathbf{R} = \left(  
\begin{matrix}
 0.3
 0.6
\end{matrix}
\right)
$$
To calculate the vector of hitting times, $\mathbf{h}$, for this chain we need to use:
$$
\mathbf{h} = ( \mathbf{I} - \mathbf{Q} )^{-1}\mathbf{1}
$$
and as such we need to invert a $2\times2$ matrix as shown below:
$$
( I - Q )^{-1} = 
\left(
\begin{matrix}
 0.4 &amp; -0.1 \\
 -0.2 &amp; 0.8
\end{matrix}
\right)^{-1} = \frac{1}{ 0.4\times0.8 - 0.1 \times 0.2 } \left(
\begin{matrix}
 0.8 &amp; 0.1 \\
 0.2 &amp; 0.4
\end{matrix} 
\right) =
\left(
\begin{matrix}
 8/3 &amp; 1/3 \\
 2/3 &amp; 4/3
\end{matrix}
\right)
$$
When this matrix is multiplied by a vector containing all ones we get the desired vector of hitting times:
$$
\mathbf{h} = ( \mathbf{I} - \mathbf{Q} )^{-1} \mathbf{1} = 
 \left(
 \begin{matrix}
  8/3 &amp; 1/3 \\
  2/3 &amp; 4/3
 \end{matrix} 
 \right)
 \left(
 \begin{matrix}
   1 \\
   1
 \end{matrix}
 \right) = 
 \left(
 \begin{matrix}
   3 \\
   2
 \end{matrix}
 \right)
$$
Now, obviously, calculating the hitting probabilities using:
$$
\mathbf{H} = ( \mathbf{I} - \mathbf{Q} )^{-1}\mathbf{R}
$$
is pointless because there is only one recurrent (absorbing) state.  Lets do 
it anyway, however, in order to confirm that the formula above gives a result 
that is in accordance with our intuition.
$$
\mathbf{H} = ( \mathbf{I} - \mathbf{Q} )^{-1} \mathbf{R} =
 \left(
 \begin{matrix}
  8/3 &amp; 1/3 \\ 
  2/3 &amp; 4/3
 \end{matrix} 
 \right)
 \left(
 \begin{matrix}
   0.3 \\
   0.6
 \end{matrix}
 \right) =
 \left(
 \begin{matrix}
   4/5 + 1/5 \\
   1/5 + 4/5
 \end{matrix}
 \right) =
 \left(
 \begin{matrix}
   1 \\
   1
 \end{matrix}
 \right)
$$
</SOLUTION>
                </div>        </div>    </div></div><h4> Problem 2</h4><div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title">        <a class="accordion-toggle" href="#collapse-1" data-parent="#accordion" data-toggle="collapse"><QUESTION>
Consider a Markov chain with the following transition matrix.  
$$
\mathbf{P} = \left(
\begin{matrix}
1/3 &amp; 1/3 &amp; 1/3 \\
0 &amp; 1/2 &amp; 1/2 \\
0 &amp; 0 &amp; 1
\end{matrix}
\right)
$$
Which of the states in this graph is
absorbing and what is the expected time till absorption if my initial state is
selected at random.
</QUESTION>
              </a>        </h4>    </div>    <div id="collapse-1" class="accordion-body collapse">        <div class="panel-body">            <div class="row"><SOLUTION>
In this chain states 1 and 2 are transient and state 3 is recurrent.  <br/> <br/>
The time taken to absorption if the initial state is selected at random, $\mathbf{E}(T)$, is equal to:
$$
\mathbf{E}(T) = \frac{5}{2} \times \frac{1}{3} + 2 \times \frac{1}{3} + 0 \times \frac{1}{3} = \frac{3}{2}
$$
</SOLUTION>
                </div>        </div>    </div></div><h4> Problem 3</h4><div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title">        <a class="accordion-toggle" href="#collapse-2" data-parent="#accordion" data-toggle="collapse"><QUESTION>
A Markov chain, between the states $X=0,1,2,3,4$,
 is  described by the following  transition matrix:
$$
\mathbf{P} = \left(
  \begin{matrix}
   1 &amp; 0 &amp; 0 &amp; 0 &amp;  0 \\
   0.3 &amp; 0.6 &amp; 0 &amp; 0 &amp; 0.1 \\
    0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
    0 &amp; 0.2 &amp; 0.3 &amp; 0.3 &amp; 0.2 
  \end{matrix}
  \right)
$$
Draw the transition graph for this chain, and show that $X=0,2$ are transient states.
Once you have done this Partition the transition matrix so that
$$
P =
\left(
\begin{matrix}
Q &amp; R \\
0  &amp; I \\
\end{matrix}
\right) 
\qquad ,
$$ 
with $Q$  connecting the transient states so that you can calculate the  
hitting probability matrix:
$$
h = (I-Q)^{-1}R \qquad ,
$$
and the hitting times.  These hitting times should tell you the expected number of steps 
starting from the transient states, until absorption occurs.
</QUESTION>
              </a>        </h4>    </div>    <div id="collapse-2" class="accordion-body collapse">        <div class="panel-body">            <div class="row"><SOLUTION>
The transition graph in this case looks like this:
<center> <img src="Images/hitting-problems-chain.png" align="middle" width="300"/> </center>
The partitioned matrix looks like this:
$$
P = \left(
\begin{matrix}
 0.6 &amp; 0.1 &amp; 0.3 &amp; 0 &amp; 0  \\ 
 0.2 &amp; 0.2 &amp; 0 &amp; 0.3 &amp; 0.3  \\
 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{matrix}
\right)
$$
The hitting probability matrix in this case is:
$$
\mathbf{H} =  
\left(
\begin{matrix}
0.8 &amp; 0.1 &amp; 0.1 \\
0.2 &amp; 0.4 &amp; 0.4
\end{matrix}
\right)
$$
The hitting times are:
$$
\mathbf{h} = \left(
 \begin{matrix}
   3 \\
   2
 \end{matrix}
 \right)
$$
</SOLUTION>
                </div>        </div>    </div></div><h4> Problem 4</h4><div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title">        <a class="accordion-toggle" href="#collapse-3" data-parent="#accordion" data-toggle="collapse"><QUESTION>
A university introduces a new mathematics degree structure. The course is
only two years long but students have to resit a year if they fail their final
examinations.  Students also have the option to resit the first and second
years if they feel they did particularly poorly during year 2.  In any given
year students perform as follows in the two years:
<table align="center">
<col width="200"/>
<col width="200"/>
<col width="200"/>
<col width="200"/>
<tr><td> </td><td> Fraction passed </td><td> Fraction failed </td><td> Fraction dropped out </td></tr>
<tr><td> Year 1 </td><td> 0.1 </td><td> 0.6 </td><td> 0.3 </td></tr> 
</table>
<br/>
<table align="center"> 
<col width="200"/>
<col width="200"/>
<col width="200"/>
<col width="200"/>
<tr><td/><td>  Fraction passed </td><td> Fraction repeat year 1 </td><td> Fraction repeat year 2 </td></tr> 
<tr><td> Year 2 </td><td> 0.6 </td><td> 0.2 </td><td> 0.2 </td></tr>
</table> 
Construct a Markov chain based on this information and use this chain to calculate the probability that a student starting this course will complete it and the 
expected number of years a student will spend at university.
</QUESTION>
              </a>        </h4>    </div>    <div id="collapse-3" class="accordion-body collapse">        <div class="panel-body">            <div class="row"><SOLUTION>
The Markov chain in this question contains four states.  In the matrix given below the states are as follows
<ol>
<li> Student in year 1 </li>
<li> Student in year 2 </li>
<li> Student dropped out of year 1 </li>
<li> Student graduated from year 2 </li>
</ol>
Notice that states 1 and 2 are thus transient and that states 3 and 4 are recurrent:
$$
\mathbf{A} = 
\left(
 \begin{matrix}
   0.6 &amp; 0.1 &amp; 0.3 &amp; 0 \\
   0.2 &amp; 0.2 &amp; 0 &amp; 0.6 \\
   0 &amp; 0 &amp; 1 &amp; 0 \\
   0 &amp; 0 &amp; 0 &amp; 1 
 \end{matrix}
 \right)
$$
By using the same techniques that were used to solve the other problems on this page we can determine that the probability a 
student completes the course is equal to $\frac{3}{15}$ and that on average each student spends three years at university.
</SOLUTION>
                </div>        </div>    </div></div>   </div></div><!-- === END CONTENT === -->
<!-- === BEGIN FOOTER === -->
<div id="base">
        <div class="container padding-vert-30">
                <div class="row">
                       <!-- Contact Details -->
                       <div class="col-md-3 margin-bottom-20">
                               <h3 class="margin-bottom-10">Contact Details</h3>
                               <p>School of Mathematics and Physics,<br />
                               Queen's University Belfast,<br />
                               Belfast,<br />
                               BT7 1NN</p>
                               <p>Email: <a href="mailto:g.tribello@qub.ac.uk">g.tribello@qub.ac.uk</a><br />
                               Website: <a href="http://titus.phy.qub.ac.uk/members/gareth/">mywebsite</a></p>
                       </div>
                       <!-- End Contact Details -->
                       <div class="clearfix"></div>
                </div>
        </div>
        <!-- Footer Menu -->
        <div id="footer">
                <div class="container">
                        <div class="row">
                                <div id="copyright" class="col-md-4">
                                        <p>(c) 2016 Gareth Tribello</p>
                                </div>
                        </div>
                </div>
        </div>
</div>
<!-- End Footer Menu -->
<!-- JS -->
<script type="text/javascript" src="assets/js/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript" src="assets/js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript" src="assets/js/scripts.js"></script>
<!-- Isotope - Portfolio Sorting -->
<script type="text/javascript" src="assets/js/jquery.isotope.js" type="text/javascript"></script>
<!-- Mobile Menu - Slicknav -->
<script type="text/javascript" src="assets/js/jquery.slicknav.js" type="text/javascript"></script>
<!-- Animate on Scroll-->
<script type="text/javascript" src="assets/js/jquery.visible.js" charset="utf-8"></script>
<!-- Slimbox2-->
<script type="text/javascript" src="assets/js/slimbox2.js" charset="utf-8"></script>
<!-- Modernizr -->
<script src="assets/js/modernizr.custom.js" type="text/javascript"></script>
<!-- End JS -->
</body>
</html>
